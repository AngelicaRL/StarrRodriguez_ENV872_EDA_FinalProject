---
title: "MP Analysis Iniciatives PDET"
author: "Angelica"
date: "2025-03-03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages("tidyverse")
#install.packages("here")
#install.packages("lubridate")
#install.packages("cowplot")
#install.packages("agricolae")
#install.packages("ggplot2")
#install.packages("dplyr")
#install.packages ("tidyr")
#install.packages ("stats")

library("tidyverse")
library("here")
library("lubridate")
library("cowplot")
library("agricolae")
library("ggplot2")
library("dplyr")
library("tidyr")
library("stats")
library(readxl)


setwd("/Users/christopherstarr/StarrRodriguez_ENV872_EDA_FinalProject")

#Read in all the excel documents and give them clearere names

#2020
IDF_2020_raw <- read_excel("IDF Indice de  Desempeño Fiscal/Anexos Desempeño Fiscal 2020_Nueva Metodología.xlsx", 
    sheet = "Municipios 2020", skip = 6)
View(IDF_2020_raw)

#2021
IDF_2021_raw <- read_excel("IDF Indice de  Desempeño Fiscal/IDF_2021_Nueva_Metodologia.xlsx", 
    sheet = "Municipios 2021", skip = 6)
View(IDF_2021_raw)

#2022
IDF_2022_raw <- read_excel("IDF Indice de  Desempeño Fiscal/Resultados IDF-Nueva Metodología 2022.xlsx", 
    skip = 5)
View(IDF_2022_raw)

#2023
IDF_2023_raw <- read_excel("IDF Indice de  Desempeño Fiscal/ResultadosIDF_Nueva_MetodologIa_2023_Act.xlsx", 
    sheet = "Municipios 2023", skip = 6)
View(IDF_2023_raw)

# Standardize 2020 dataset
IDF_2020_std <- IDF_2020_raw %>%
  rename(
    "Código" = "Codigo DANE",
    "Categorías" = "Categoría Ley 617",
    "Ciudad capital" = "Capitales",
    "Endeudamiento (Total)" = "Endeudamiento Largo Plazo",
    "Calificación Endeudamiento Total" = "Calificación Endeudamiento Largo Plazo",
    "Capacidad de programación y recaudo de ingresos" = "Capacidad de Ejecución de Ingresos",
    "Calificación capacidad de programación y recaudo de Ingresos" = "Calificación Capacidad de Ejecución de Ingresos",
    "Bonificación Esfuerzo Propio" = "Bonificación Esfuerzo Porpio"
  )

# Standardize 2021 dataset
IDF_2021_std <- IDF_2021_raw %>%
  rename(
    "Código" = "Codigo DANE",
    "Categorías" = "Categoría Ley 617",
    "Ciudad capital" = "Capitales",
    "Endeudamiento (Total)" = "Endeudamiento Largo Plazo",
    "Calificación Endeudamiento Total" = "Calificación Endeudamiento Largo Plazo",
    "Capacidad de programación y recaudo de ingresos" = "Capacidad de Ejecución de Ingresos",
    "Calificación capacidad de programación y recaudo de Ingresos" = "Calificación Capacidad de Ejecución de Ingresos"
  )

# Standardize 2022 dataset
IDF_2022_std <- IDF_2022_raw %>%
  rename(
    "Calificación Capacidad de Ejecución de Inversión" = "Capacidad de Ejecución de Inversión *", 
    "Gestión" = "Resultados Gestión",
    "Calificación Gestión" = "Calificación Resultados Gestión"
  )

# Standardize 2023 dataset
IDF_2023_std <- IDF_2023_raw %>%
  rename(
    "Gestión" = "Resultados Gestión",
    "Calificación Gestión" = "Calificación Resultados Gestión"
  )

# Function to add any missing standard columns and set them to NA
add_missing_columns <- function(df) {
  for (col in standard_columns) {
    if (!col %in% names(df)) {
      df[[col]] <- NA
    }
  }
  return(df)
}


```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
